<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Activity Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(to right, #e0f7fa, #ccecf0);
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        .sidebar {
            width: 200px;
            background-color: #2c3e50;
            box-shadow: 6px 0 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            padding: 30px 20px;
            border-radius: 0 15px 15px 0;
            flex-shrink: 0;
            color: #ecf0f1;
        }

        .sidebar .logo-container {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar .logo-container img {
            width: 160px;
            height: auto;
        }

        .sidebar h2 {
            font-size: 2rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 40px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 20px;
        }

        .sidebar nav {
            flex-grow: 1;
        }

        .sidebar button {
            width: 100%;
            text-align: left;
            padding: 16px 15px;
            border-radius: 10px;
            font-size: 1.05rem;
            font-weight: 600;
            color: #bdc3c7;
            background-color: transparent;
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 300ms ease-in-out;
            outline: none;
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .sidebar button:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            border-color: rgba(255, 255, 255, 0.2);
        }

        .sidebar button.active {
            background-color: #3498db;
            color: #ffffff;
            border-color: #3498db;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
            transform: translateY(-2px);
        }

        .sidebar .quick-links {
            margin-top: 40px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar .quick-links h3 {
            font-size: 1.2rem;
            font-weight: 700;
            color: #ffffff;
            margin-bottom: 20px;
            padding-left: 5px;
        }

        .sidebar .quick-links ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar .quick-links li {
            margin-bottom: 10px;
        }

        .sidebar .quick-links a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            border-radius: 8px;
            text-decoration: none;
            color: #bdc3c7;
            font-size: 1rem;
            transition: all 250ms ease-in-out;
        }

        .sidebar .quick-links a i {
            font-size: 20px;
            color: currentColor;
        }

        .sidebar .quick-links a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 32px;
            overflow: auto;
            background-color: #f8f9fa;
        }

        .header-section {
            background-color: #ffffff;
            padding: 35px;
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
            display: flex;
            gap: 30px;
            align-items: flex-end;
            flex-wrap: wrap;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            width: 100%;
            flex-grow: 1;
            flex-basis: 0;
            min-width: 250px;
        }

        .input-group label {
            display: block;
            font-size: 0.95rem;
            font-weight: 500;
            color: #4a5568;
            margin-bottom: 10px;
        }

        .input-field {
            width: 100%;
            padding: 14px 18px;
            border: 1px solid #cdd4dc;
            border-radius: 10px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
            outline: none;
            box-sizing: border-box;
            font-size: 1rem;
            color: #333d47;
            transition: all 0.3s ease-in-out;
        }

        .input-field:focus {
            border-color: #3498db;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.3);
        }

        .input-field[readonly] {
            background-color: #f0f4f8;
            cursor: not-allowed;
            color: #7b8696;
            box-shadow: none;
        }

        .relative-input-group {
            position: relative;
            display: flex;
            flex-direction: column;
            width: 100%;
            flex-shrink: 0;
            flex-basis: 0;
            flex-grow: 1;
        }

        .search-input-group {
            position: relative;
        }

        .search-input-group .input-field {
            padding-right: 50px;
        }

        .search-input-group .search-icon {
            position: absolute;
            right: 20px;
            top: 69%;
            transform: translateY(-50%);
            color: #7b8696;
            pointer-events: none;
            font-size: 24px;
        }

        .calendar-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #7b8696;
            pointer-events: none;
            font-size: 20px;
            z-index: 2;
            margin-top: 10px;
        }

        input[type="date"] {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            padding-right: 40px;
            cursor: pointer;
            position: relative;
            z-index: 1;
            color: transparent;
            background-color: #ffffff;
        }

        input[type="date"]::-webkit-calendar-picker-indicator {
            opacity: 0;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            cursor: pointer;
            z-index: 3;
        }

        input[type="date"]::-webkit-inner-spin-button,
        input[type="date"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .calendar-range-display {
            position: absolute;
            top: 0;
            left: 0;
            width: calc(100% - 40px);
            height: 100%;
            display: flex;
            align-items: center;
            padding: 0 16px;
            color: #333d47;
            pointer-events: none;
            font-size: 1rem;
            line-height: 1.5;
            box-sizing: border-box;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            background-color: transparent;
            font-weight: 500;
            z-index: 2;
            margin-top: 10px;
        }

        .activities-section {
            flex: 1;
            background-color: #ffffff;
            padding: 28px;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            overflow: scroll;
            scrollbar-width: none;
        }

        .activities-section h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 24px;
            text-align: center;
            border-bottom: 1px solid #e0e6ec;
            padding-bottom: 12px;
        }

        .activities-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .total-hours-summary {
            background-color: #e0f2fe;
            color: #0c4a6e;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 1.1rem;
            font-weight: 600;
            text-align: center;
            border: 1px solid #bfdbfe;
        }

        .daily-progress {
            margin-bottom: 25px;
            border: 1px solid #e0e6ec;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .daily-header {
            background-color: #f0f4f8;
            padding: 12px 20px;
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e0e6ec;
        }

        .daily-hours {
            font-size: 1rem;
            font-weight: 500;
            color: #0c4a6e;
            background-color: #dbeafe;
            padding: 4px 10px;
            border-radius: 6px;
        }

        .activities-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            border-radius: 8px;
            overflow: hidden;
        }

        .activities-table th,
        .activities-table td {
            padding: 14px 20px;
            text-align: left;
            border-bottom: 1px solid #ebf1f5;
        }

        .activities-table th {
            background-color: #f0f4f8;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.07em;
        }

        .activities-table tbody tr:hover {
            background-color: #fbfdff;
        }

        .activities-table td {
            font-size: 0.9rem;
            color: #333d47;
            vertical-align: top;
        }

        .activities-table .tech-tags-cell {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .activities-table .tech-tag {
            padding: 5px 10px;
            background-color: #e0f2fe;
            color: #1c64f2;
            font-size: 0.7rem;
            font-weight: 600;
            border-radius: 20px;
            white-space: nowrap;
            border: 1px solid #a7d9ff;
        }

        .status-completed {
            background-color: #d1fae5;
            color: #065f46;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
            border: 1px solid #a7f3d0;
            white-space: nowrap;
        }

        .status-in-progress {
            background-color: #fffbeb;
            color: #b45309;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
            border: 1px solid #fde68a;
            white-space: nowrap;
        }

        .status-pending {
            background-color: #fee2e2;
            color: #991b1b;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
            border: 1px solid #fca5a5;
            white-space: nowrap;
        }

        .status-reviewed {
            background-color: #eff6ff;
            color: #1e40af;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
            border: 1px solid #bfdbfe;
            white-space: nowrap;
        }

        .status-blocked {
            background-color: #f3e8ff;
            color: #6d28d9;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            display: inline-block;
            border: 1px solid #d8b4fe;
            white-space: nowrap;
        }

        .activity-type-development {
            color: #047857;
            font-weight: 500;
        }

        .activity-type-meeting {
            color: #7c3aed;
            font-weight: 500;
        }

        .activity-type-review {
            color: #be185d;
            font-weight: 500;
        }

        .activity-type-documentation {
            color: #0f766e;
            font-weight: 500;
        }

        .activity-type-bug-fix {
            color: #dc2626;
            font-weight: 500;
        }

        .activity-type-design {
            color: #a21caf;
            font-weight: 500;
        }

        .activity-type-devops {
            color: #0e7490;
            font-weight: 500;
        }

        .activity-type-testing {
            color: #5b21b6;
            font-weight: 500;
        }

        .activity-type-research {
            color: #d97706;
            font-weight: 500;
        }

        .activity-type-planning {
            color: #16a34a;
            font-weight: 500;
        }

        .activity-type-setup {
            color: #4338ca;
            font-weight: 500;
        }

        .activity-type-optimization {
            color: #c2410c;
            font-weight: 500;
        }

        .activity-type-code-review {
            color: #0f766e;
            font-weight: 500;
        }

        .activity-type-refactoring {
            color: #84269e;
            font-weight: 500;
        }

        .activity-type-database {
            color: #2563eb;
            font-weight: 500;
        }

        .activity-type-mentoring {
            color: #22c55e;
            font-weight: 500;
        }

        .activity-type-meeting-prep {
            color: #ef4444;
            font-weight: 500;
        }

        .message-text {
            color: #55606e;
            font-size: 1.05rem;
            text-align: center;
            padding: 20px;
            background-color: #f0f4f8;
            border-radius: 8px;
            border: 1px solid #d3e0ed;
        }

        .error-text {
            color: #cc0000;
            font-weight: 600;
            padding: 12px;
            background-color: #fee2e2;
            border: 1px solid #fca5a5;
            border-radius: 8px;
            text-align: center;
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="logo-container">
            <img src="logo.png" alt="Company Logo">
        </div>
        <nav>
            <button id="weeklyTab">
                <i class='bx bx-calendar'></i>
                Weekly
            </button>
            <button id="monthlyTab">
                <i class='bx bx-calendar-alt'></i>
                Monthly
            </button>
        </nav>
        <div class="quick-links">
            <h3>Quick Links</h3>
            <ul>
                <li>
                    <a href="#reports">
                        <i class='bx bx-chart'></i>
                        Reports
                    </a>
                </li>
                <li>
                    <a href="#settings">
                        <i class='bx bx-cog'></i>
                        Settings
                    </a>
                </li>
                <li>
                    <a href="#help">
                        <i class='bx bx-help-circle'></i>
                        Help & Support
                    </a>
                </li>
            </ul>
        </div>
    </aside>

    <main class="main-content">
        <header class="header-section">
            <div class="input-group search-input-group">
                <label for="employeeIdSearch">Employee ID (e.g., ATS123)</label>
                <input type="text" id="employeeIdSearch" placeholder="Search Employee ID" class="input-field">
                <i class='bx bx-search search-icon'></i>
            </div>
            <div class="input-group">
                <label for="employeeName">Name of the employee</label>
                <input type="text" id="employeeName" placeholder=" Employee Name" readonly class="input-field">
            </div>

            <div class="relative-input-group" id="referenceDateGroup">
                <label for="calendarInput">Calendar</label>
                <input type="date" id="calendarInput" class="input-field">
                <span id="calendarRangeDisplay" class="calendar-range-display"></span>
                <i class='bx bx-calendar calendar-icon'></i>
            </div>

        </header>

        <section class="activities-section">
            <h3>Employee Activities</h3>
            <div id="activitiesContent" class="activities-content">
                <p class="message-text">Search for an employee ID to view their activities.</p>
            </div>
        </section>
    </main>

    <script>
    const currentYear = new Date().getFullYear();
    function getRandomActivity(date, employeeName, projectPrefix) {
        const activityTypes = ["Development", "Meeting", "Code Review", "Testing", "Documentation", "Bug Fix", "Planning", "Research", "Training", "Design", "Optimization", "DevOps"];
        const technologies = [
            ["React", "JavaScript", "HTML", "CSS", "TypeScript"],
            ["Node.js", "Express.js", "MongoDB", "Redis"],
            ["Python", "Django", "FastAPI"],
            ["Java", "Spring Boot", "Kafka"],
            ["AWS", "GCP", "Kubernetes"],
            ["Figma", "Sketch", "Blender"],
            ["Git", "Jira", "Asana"],
            ["Jest", "Playwright", "Cypress"],
            ["PowerBI", "Looker Studio", "SQL"]
        ];
        const statuses = ["Completed", "In Progress", "Pending", "Reviewed", "Blocked"];
        const remarksOptions = [
            "Finalized sprint tasks.",
            "Prepared quarterly report.",
            "Optimized database queries for performance.",
            "Conducted peer code review.",
            "Researched new AI integration.",
            "Deployed to production environment.",
            "Attended client demo.",
            "Troubleshooted network connectivity.",
            "Documented API endpoints.",
            "Refactored legacy code module."
        ];
        const teamLeads = ["Samantha Green", "Robert Brown", "Jessica Lee", "Chris Evans"];

        const randomType = activityTypes[Math.floor(Math.random() * activityTypes.length)];
        const randomTechs = technologies[Math.floor(Math.random() * technologies.length)].slice(0, Math.floor(Math.random() * 3) + 1);
        const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
        const randomHours = Math.floor(Math.random() * 8) + 1;
        const randomRemarks = remarksOptions[Math.floor(Math.random() * remarksOptions.length)];
        const randomProject = projectPrefix + String(Math.floor(Math.random() * 10) + 1);
        const randomTeamLead = teamLeads[Math.floor(Math.random() * teamLeads.length)];
        return {
            date: date,
            description: `Worked on ${randomType} activity.`,
            technologies: randomTechs,
            status: randomStatus,
            project: randomProject,
            hours_spent: randomHours,
            type: randomType,
            remarks: randomRemarks,
            team_lead: randomTeamLead
        };
    }

    const employees = {
        "ATS001": {
            name: "Liam Smith",
            getActivities: function(startDate, endDate) {
                const activities = [];
                let currentDate = new Date(startDate);
                currentDate.setHours(0, 0, 0, 0);

                const loopEndDate = new Date(endDate);
                loopEndDate.setHours(23, 59, 59, 999);
                const today = new Date();
                today.setHours(23, 59, 59, 999);

                while (currentDate <= loopEndDate && currentDate <= today) {
                    const numActivities = 1;
                    for (let i = 0; i < numActivities; i++) {
                        const activityDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
                        activities.push(getRandomActivity(activityDate.toISOString().split('T')[0], this.name, "Project Fusion"));
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                return activities;
            }
        },
        "ATS002": {
            name: "Olivia Jones",
            getActivities: function(startDate, endDate) {
                const activities = [];
                let currentDate = new Date(startDate);
                currentDate.setHours(0, 0, 0, 0);

                const loopEndDate = new Date(endDate);
                loopEndDate.setHours(23, 59, 59, 999);
                const today = new Date();
                today.setHours(23, 59, 59, 999);

                while (currentDate <= loopEndDate && currentDate <= today) {
                    const numActivities = 1;
                    for (let i = 0; i < numActivities; i++) {
                        const activityDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
                        activities.push(getRandomActivity(activityDate.toISOString().split('T')[0], this.name, "Project Nexus"));
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                return activities;
            }
        },
        "ATS003": {
            name: "Noah Davis",
            getActivities: function(startDate, endDate) {
                const activities = [];
                let currentDate = new Date(startDate);
                currentDate.setHours(0, 0, 0, 0);

                const loopEndDate = new Date(endDate);
                loopEndDate.setHours(23, 59, 59, 999);
                const today = new Date();
                today.setHours(23, 59, 59, 999);

                while (currentDate <= loopEndDate && currentDate <= today) {
                    const numActivities = 1;
                    for (let i = 0; i < numActivities; i++) {
                        const activityDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
                        activities.push(getRandomActivity(activityDate.toISOString().split('T')[0], this.name, "Project Phoenix"));
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                return activities;
            }
        },
        "ATS004": {
            name: "Sophia Miller",
            getActivities: function(startDate, endDate) {
                const activities = [];
                let currentDate = new Date(startDate);
                currentDate.setHours(0, 0, 0, 0);

                const loopEndDate = new Date(endDate);
                loopEndDate.setHours(23, 59, 59, 999);
                const today = new Date();
                today.setHours(23, 59, 59, 999);

                while (currentDate <= loopEndDate && currentDate <= today) {
                    const numActivities = 1;
                    for (let i = 0; i < numActivities; i++) {
                        const activityDate = new Date(currentDate.getFullYear(), currentDate.getMonth(), currentDate.getDate());
                        activities.push(getRandomActivity(activityDate.toISOString().split('T')[0], this.name, "Project Zenith"));
                    }
                    currentDate.setDate(currentDate.getDate() + 1);
                }
                return activities;
            }
        }
    };
    const weeklyTab = document.getElementById('weeklyTab');
    const monthlyTab = document.getElementById('monthlyTab');
    const employeeIdSearch = document.getElementById('employeeIdSearch');
    const employeeNameInput = document.getElementById('employeeName');
    const calendarInput = document.getElementById('calendarInput');
    const calendarRangeDisplay = document.getElementById('calendarRangeDisplay');
    const referenceDateGroup = document.getElementById('referenceDateGroup');


    let currentTab = 'weekly';
    function formatDate(date) {
        return date.toLocaleDateString('en-US', { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' });
    }

    function formatDateWithoutWeekday(date) {
        return date.toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
    }

    function formatShortDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    }

    function updateCalendarRange(referenceDateOrStartDate = null) {
        let startDate, endDate;
        referenceDateGroup.style.display = 'none';
        calendarRangeDisplay.textContent = '';

        if (currentTab === 'weekly') {
            referenceDateGroup.style.display = 'flex';
            let refDate = referenceDateOrStartDate || (calendarInput.value ? new Date(calendarInput.value) : new Date());
            refDate.setHours(0, 0, 0, 0);
            let dayOfWeek = refDate.getDay();
            let diffToMonday = dayOfWeek === 0 ? 6 : dayOfWeek - 1;
            startDate = new Date(refDate);
            startDate.setDate(refDate.getDate() - diffToMonday);
            startDate.setHours(0, 0, 0, 0);

            let trueWeekEndDate = new Date(startDate);
            trueWeekEndDate.setDate(startDate.getDate() + 6);
            trueWeekEndDate.setHours(23, 59, 59, 999);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (trueWeekEndDate > today) {
                endDate = new Date(today);
                endDate.setHours(23, 59, 59, 999);
            } else {
                endDate = trueWeekEndDate;
            }

            calendarInput.value = formatShortDate(refDate);
            calendarRangeDisplay.textContent = `${formatDate(startDate)} - ${formatDate(endDate)}`;
        } else if (currentTab === 'monthly') {
            referenceDateGroup.style.display = 'flex';
            let refDate = referenceDateOrStartDate || (calendarInput.value ? new Date(calendarInput.value) : new Date());
            refDate.setHours(0, 0, 0, 0);
            startDate = new Date(refDate.getFullYear(), refDate.getMonth(), 1);
            startDate.setHours(0, 0, 0, 0);

            endDate = new Date(refDate.getFullYear(), refDate.getMonth() + 1, 0);
            endDate.setHours(23, 59, 59, 999);
            calendarInput.value = formatShortDate(refDate);
            calendarRangeDisplay.textContent = `${formatDate(startDate)} - ${formatDate(endDate)}`;
        }

        return { startDate, endDate };
    }

    function setActiveTab(tabName) {
        currentTab = tabName;
        weeklyTab.classList.remove('active');
        monthlyTab.classList.remove('active');
        if (tabName === 'weekly') {
            weeklyTab.classList.add('active');
        } else if (tabName === 'monthly') {
            monthlyTab.classList.add('active');
        }

        referenceDateGroup.style.display = 'flex';
        const initialReferenceDate = new Date(calendarInput.value || new Date());
        initialReferenceDate.setHours(0, 0, 0, 0);

        const { startDate, endDate } = updateCalendarRange(initialReferenceDate);
        displayEmployeeActivities(startDate, endDate);
    }

    function displayEmployeeActivities(filterStartDate, filterEndDate) {
        const employeeId = employeeIdSearch.value.trim().toUpperCase();
        const employee = employees[employeeId];
        activitiesContent.innerHTML = '';

        if (!employeeId) {
            employeeNameInput.value = '';
            activitiesContent.innerHTML = '<p class="message-text">Search for an employee ID to view their activities.</p>';
            return;
        }

        if (!employee) {
            employeeNameInput.value = '';
            activitiesContent.innerHTML = '<p class="message-text">No employee found with this ID. Please use ATSXXX format.</p>';
            return;
        }

        employeeNameInput.value = employee.name;
        console.log(`Displaying activities for: ${employeeId}, Start Date: ${formatDate(filterStartDate)}, End Date: ${formatDate(filterEndDate)}`);
        const filteredActivities = employee.getActivities(filterStartDate, filterEndDate);
        if (currentTab === 'monthly' && filteredActivities.length === 0) {
            activitiesContent.innerHTML = `<p class="message-text">No activities found for ${employee.name} in the selected period.</p>`;
            return;
        }


        const activitiesByDate = {};
        filteredActivities.forEach(activity => {
            const dateKey = formatShortDate(new Date(activity.date));
            if (!activitiesByDate[dateKey]) {
                activitiesByDate[dateKey] = [];
            }
            activitiesByDate[dateKey].push(activity);
        });
        if (currentTab === 'monthly') {
            const table = document.createElement('table');
            table.classList.add('activities-table');
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');

            const headerRow = document.createElement('tr');
            ['Date', 'Project', 'Activity Type', 'Description', 'Technologies', 'Hours Spent', 'Status', 'Team Lead', 'Remarks'].forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const activitiesToShowInMonthly = filteredActivities.filter(activity => {
                const activityDate = new Date(activity.date);
                return activityDate.getDay() !== 0;
            });
            activitiesToShowInMonthly.sort((a, b) => new Date(a.date) - new Date(b.date));
            activitiesToShowInMonthly.forEach(activity => {
                const tr = document.createElement('tr');

                const dateTd = document.createElement('td');
                dateTd.textContent = formatDate(new Date(activity.date));
                tr.appendChild(dateTd);

                const projectTd = document.createElement('td');
                projectTd.textContent = activity.project || 'N/A';
                tr.appendChild(projectTd);

                const typeTd = document.createElement('td');
                typeTd.textContent = activity.type || 'N/A';
                if (activity.type) {
                    const typeClass = activity.type.toLowerCase().replace(/\s/g, '-').replace('/', '-');
                    typeTd.classList.add(`activity-type-${typeClass}`);
                }
                tr.appendChild(typeTd);

                const descTd = document.createElement('td');
                descTd.textContent = activity.description;
                tr.appendChild(descTd);
                const techTd = document.createElement('td');
                const techTagsContainer = document.createElement('div');
                techTagsContainer.classList.add('tech-tags-cell');
                if (activity.technologies && activity.technologies.length > 0) {
                    activity.technologies.forEach(tech => {
                        const techSpan = document.createElement('span');
                        techSpan.classList.add('tech-tag');
                        techSpan.textContent = tech;
                        techTagsContainer.appendChild(techSpan);
                    });
                } else {
                    techTagsContainer.textContent = 'N/A';
                }
                techTd.appendChild(techTagsContainer);
                tr.appendChild(techTd);
                const hoursTd = document.createElement('td');
                hoursTd.textContent = (activity.hours_spent !== undefined ? activity.hours_spent : 'N/A');
                tr.appendChild(hoursTd);
                const statusTd = document.createElement('td');
                statusTd.textContent = activity.status || 'N/A';
                if (activity.status) {
                    const statusClass = activity.status.toLowerCase().replace(/\s/g, '-');
                    statusTd.classList.add(`status-${statusClass}`);
                }
                tr.appendChild(statusTd);
                const teamLeadTd = document.createElement('td');
                teamLeadTd.textContent = activity.team_lead || 'N/A';
                tr.appendChild(teamLeadTd);

                const remarksTd = document.createElement('td');
                remarksTd.textContent = activity.remarks || 'N/A';
                tr.appendChild(remarksTd);
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);
            activitiesContent.appendChild(table);
        } else {
            const oneDay = 24 * 60 * 60 * 1000;
            const numDays = Math.round(Math.abs((filterEndDate.getTime() - filterStartDate.getTime()) / oneDay)) + 1;
            let dailyIterator = new Date(filterStartDate);
            for (let i = 0; i < numDays; i++) {
                const displayDay = new Date(dailyIterator);
                displayDay.setHours(0, 0, 0, 0);
                const dayOfWeek = displayDay.getDay();

                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    dailyIterator.setDate(dailyIterator.getDate() + 1);
                    continue;
                }

                const dateKey = formatShortDate(displayDay);
                const dailyActivities = activitiesByDate[dateKey] || [];

                const dayHeader = document.createElement('h4');
                dayHeader.style.marginTop = '20px';
                dayHeader.style.marginBottom = '10px';
                dayHeader.style.color = '#34495e';
                dayHeader.style.fontSize = '1.1rem';
                dayHeader.textContent = formatDateWithoutWeekday(displayDay);

                activitiesContent.appendChild(dayHeader);
                if (dailyActivities.length === 0) {
                    const noActivitiesMsg = document.createElement('p');
                    noActivitiesMsg.classList.add('message-text');
                    noActivitiesMsg.textContent = `No activities recorded for this day.`;
                    activitiesContent.appendChild(noActivitiesMsg);
                } else {
                    const table = document.createElement('table');
                    table.classList.add('activities-table');
                    const thead = document.createElement('thead');
                    const tbody = document.createElement('tbody');

                    const headerRow = document.createElement('tr');
                    ['Project', 'Activity Type', 'Description', 'Technologies', 'Hours Spent', 'Status', 'Team Lead', 'Remarks'].forEach(headerText => {
                        const th = document.createElement('th');
                        th.textContent = headerText;
                        headerRow.appendChild(th);
                    });
                    thead.appendChild(headerRow);
                    table.appendChild(thead);

                    dailyActivities.sort((a, b) => new Date(a.date) - new Date(b.date));
                    dailyActivities.forEach(activity => {
                        const tr = document.createElement('tr');

                        const projectTd = document.createElement('td');
                        projectTd.textContent = activity.project || 'N/A';
                        tr.appendChild(projectTd);

                        const typeTd = document.createElement('td');
                        typeTd.textContent = activity.type || 'N/A';
                        if (activity.type) {
                            const typeClass = activity.type.toLowerCase().replace(/\s/g, '-').replace('/', '-');
                            typeTd.classList.add(`activity-type-${typeClass}`);
                        }
                        tr.appendChild(typeTd);

                        const descTd = document.createElement('td');
                        descTd.textContent = activity.description;
                        tr.appendChild(descTd);
                        const techTd = document.createElement('td');
                        const techTagsContainer = document.createElement('div');
                        techTagsContainer.classList.add('tech-tags-cell');
                        if (activity.technologies && activity.technologies.length > 0) {
                            activity.technologies.forEach(tech => {
                                const techSpan = document.createElement('span');
                                techSpan.classList.add('tech-tag');
                                techSpan.textContent = tech;
                                techTagsContainer.appendChild(techSpan);
                            });
                        } else {
                            techTagsContainer.textContent = 'N/A';
                        }
                        techTd.appendChild(techTagsContainer);
                        tr.appendChild(techTd);

                        const hoursTd = document.createElement('td');
                        hoursTd.textContent = (activity.hours_spent !== undefined ? activity.hours_spent : 'N/A');
                        tr.appendChild(hoursTd);

                        const statusTd = document.createElement('td');
                        statusTd.textContent = activity.status || 'N/A';
                        if (activity.status) {
                            const statusClass = activity.status.toLowerCase().replace(/\s/g, '-');
                            statusTd.classList.add(`status-${statusClass}`);
                        }
                        tr.appendChild(statusTd);
                        const teamLeadTd = document.createElement('td');
                        teamLeadTd.textContent = activity.team_lead || 'N/A';
                        tr.appendChild(teamLeadTd);

                        const remarksTd = document.createElement('td');
                        remarksTd.textContent = activity.remarks || 'N/A';
                        tr.appendChild(remarksTd);
                        tbody.appendChild(tr);
                    });
                    table.appendChild(tbody);
                    activitiesContent.appendChild(table);
                }
                dailyIterator.setDate(dailyIterator.getDate() + 1);
            }
        }
    }

    weeklyTab.addEventListener('click', () => setActiveTab('weekly'));
    monthlyTab.addEventListener('click', () => setActiveTab('monthly'));

    calendarInput.addEventListener('change', () => {
        if (currentTab === 'weekly' || currentTab === 'monthly') {
            const selectedDate = new Date(calendarInput.value);
            const { startDate, endDate } = updateCalendarRange(selectedDate);
            displayEmployeeActivities(startDate, endDate);
        }
    });
    employeeIdSearch.addEventListener('input', () => {
        const employeeId = employeeIdSearch.value.trim().toUpperCase();
        const isValidFormat = /^ATS\d{3}$/.test(employeeId);

        if (isValidFormat || employeeId === '') {
            let startDate, endDate;
            const currentCalendarDate = calendarInput.value ? new Date(calendarInput.value) : new Date();
            const range = updateCalendarRange(currentCalendarDate);
            startDate = range.startDate;
            endDate = range.endDate;
            displayEmployeeActivities(startDate, endDate);
        } else {
            employeeNameInput.value = '';
            activitiesContent.innerHTML = '<p class="error-text">Invalid Employee ID format. Please use ATSXXX (e.g., ATS123).</p>';
        }
    });
    const today = new Date();
    calendarInput.setAttribute('max', today.toISOString().split('T')[0]);

    const todayISO = today.toISOString().split('T')[0];
    calendarInput.value = todayISO;


    setActiveTab('weekly');
</script>
</body>
</html>